<html>

<head>
    <meta charset="utf-8" />
    <title>Miracle Map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />

    <!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.4.0/dist/esri-leaflet.js" integrity="sha512-kq0i5Xvdq0ii3v+eRLDpa++uaYPlTuFaOYrfQ0Zdjmms/laOwIvLMAxh7cj1eTqqGG47ssAcTY4hjkWydGt6Eg==" crossorigin=""></script>

    <!--    Load Google Fonts-->
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Open+Sans&display=swap" rel="stylesheet">


    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            right: 0;
            left: 0;
        }

        #title {
            position: absolute;
            top: 10px;
            right: 20px;
            width: 275px;
            height: 75px;
            background-color: white;
            z-index: 1000;
            opacity: .9;
        }

        h1 {
            font-family: 'Abril Fatface', cursive;
            font-size: 2em;
            font-weight: normal;
            color: black;
            position: relative;
            top: -25px;
        }

        h2 {
            font-family: 'Open Sans', sans-serif;
            font-size: .75em;
            position: relative;
            top: -50px;
        }

        h3 {
            font-family: 'Abril Fatface', cursive;
            font-size: 1.5em;
            font-weight: normal;
            color: black;
        }


        h4 {
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            font-weight: normal;
            color: black;
        }

        p {
            font-family: 'Open Sans', sans-serif;
            font-size: .75em;
        }
    </style>
</head>

<body>
    <div id="title">
        <center>
            <h1>The Miracle Map</h1>
            <h2>Explain the map's purpose here<br>
                <a href='https://survey123.arcgis.com/share/4a29e55a7808471894ccc8d9f370820b?portalUrl=https://miraclemapper.maps.arcgis.com' target="_blank">Submit a miracle</a></h2>
        </center>


    </div>
    <div id="map"></div>
    <script>
        var map = L.map('map').setView([33, 36], 9);

        // add basemap conducive to firefly symbology
        L.esri.basemapLayer('ImageryFirefly').addTo(map);

        // need to create a public view of the hosted feature layer in AGO to access point data here
        // the url below is for the public hosted layer view
        var data = L.esri.featureLayer({
            url: 'https://services9.arcgis.com/fSxmsxg6MME8SObM/arcgis/rest/services/Miracles_GOLD_MASTER_view/FeatureServer/0'
        });
        addMiracles(data);

        function addMiracles(data) {
            // add data and popup to the map
            data.bindPopup(function(layer) {
                // access a field from the attribute table
                var video = L.Util.template('{links}', layer.feature.properties);
                // customize the popup
                return L.Util.template('<h3>MIRACLE NAME</h3><h4>Condition: {Condition}<br>Video Testimony: {links}</h4>', layer.feature.properties);
            }).addTo(map);
        }
    </script>

</body></html>
